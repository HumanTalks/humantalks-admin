@import com.humantalks.exposed.proposals.Proposal
@import com.humantalks.internal.talks.Talk
@import com.humantalks.internal.persons.Person
@import global.views.html.format._
@import com.humantalks.common.views.html.format._
@import com.humantalks.internal.views.html.partials._
@import com.humantalks.internal.proposals.routes.ProposalCtrl
@import com.humantalks.internal.talks.routes.TalkCtrl
@(proposal: Proposal, talkOpt: Option[Talk], personList: List[Person])(implicit request: RequestHeader, messagesApi: MessagesApi, userOpt: Option[Person])
@main(proposal.data.title) {
    @header("proposal")

    <div class="container">
        <h1>
            @proposal.data.title
            @partials.status(proposal)
        </h1>
        <p>@speakers(proposal.data.speakers, personList) @created(proposal.meta.created)</p>
        @talkOpt.map{talk => <p><b>Talk associé : <a href="@TalkCtrl.get(talk.id)">@talk.data.title</a></b> @com.humantalks.internal.talks.views.html.partials.status(talk)</p>}
        @proposal.data.description.map{d => <p>@multiline(d)</p>}
        @slidesEmbed(proposal.data.slidesEmbedCode, proposal.data.slides)
        @if(proposal.status == Proposal.Status.Proposed) {
            @helper.form(action=ProposalCtrl.doReject(proposal.id), 'class->"inline") { <button type="submit" class="btn btn-danger" title="Rejeter cette proposition" confirm>Rejeter</button> }
            @helper.form(action=ProposalCtrl.doAccept(proposal.id), 'class->"inline") { <button type="submit" class="btn btn-success" title="Accepter cette proposition" confirm>Accepter</button> }
        }
        @if(proposal.data.availabilities.length > 0){
            <h3>Disponibilités</h3>
            <ul>
                @proposal.data.availabilities.map { d => <li>@date(d, Some("dd MMMM yyyy"))</li> }
            </ul>
        }
    </div>
}